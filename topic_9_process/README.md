# 玩转进程
## 指引
> JavaScript 代码永远运行在 V8上，是单线程的。

JavaScript将会运行在单个进程的单个线程上。
它带来的好处是：程序状态是单一的，在没有多线程的情况下**没有锁、线程同步**问题，操作系统在调度时也因为较少上下文的切换，可以很好地提高CPU的使用率。
但也带来了问题：

1. 单线程抛出的异常如何捕获？
2. 如何充分利用多核 CPU 服务器？

## 服务模型的变迁
```
同步 -> 复制进程 -> 多线程 -> 事件驱动
```

## 多进程架构
每个进程各自利用一个CPU，以此实现多核CPU的利用。Node 提供了 child_process 模块。
实例见`code`

### 主从模式
通过 `fork` 复制的进程都是一个独立的进程，这个进程中有着独立而全新的 V8 实例。它需要至少 30ms 的启动时间
和至少 10MB 的内存。可见 `fork` 进程是昂贵的。
### 创建子进程
<img src="./img/method_diff.png">

### 进程间通信
在 Master-Worker 模式中，要实现主进程管理和调度工作进程的功能，需要主进程和工作进程之间的通信。

